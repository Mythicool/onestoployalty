<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Join the One Stop Anime Loyalty Program and open your exclusive reward pack! Collect rare discounts and special offers.">
    <meta name="theme-color" content="#070709">
    <title>One Stop Anime - Loyalty Pack Opening</title>

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;700;900&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- Netlify Identity Widget -->
    <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- Favicon (using emoji as data URI) -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå∏</text></svg>">
</head>

<body>
    <!-- Sakura Particle Container -->
    <div class="particle-container" id="particles" aria-hidden="true"></div>

    <!-- ==========================================
         LANDING SCREEN
         ========================================== -->
    <div class="screen active" id="landing-screen">
        <div class="logo-container">
            <span class="sakura" aria-hidden="true">üå∏</span>
            <h1 class="logo">One Stop Anime</h1>
            <span class="sakura" aria-hidden="true">üå∏</span>
        </div>

        <h2 class="tagline">LOYALTY REWARDS</h2>
        <p class="subtitle">Open your welcome pack and discover your exclusive reward tier!</p>

        <!-- Welcome Back Message (shown for logged-in users) -->
        <div class="welcome-back hidden" id="welcome-back">
            <span class="welcome-emoji">üëã</span>
            <span class="welcome-text">Welcome back, <strong id="welcome-name">Trainer</strong>!</span>
        </div>

        <!-- Pack Preview -->
        <div class="pack-preview">
            <div class="pack-glow" aria-hidden="true"></div>
            <div class="pack-wrapper">
                <!-- Custom OSA Loyalty Pack SVG -->
                <svg class="pack-image" viewBox="0 0 200 280" xmlns="http://www.w3.org/2000/svg" role="img"
                    aria-label="One Stop Anime Loyalty Pack">
                    <defs>
                        <!-- Main gradient -->
                        <linearGradient id="packGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#FF2D8A" />
                            <stop offset="50%" style="stop-color:#A855F7" />
                            <stop offset="100%" style="stop-color:#00D4FF" />
                        </linearGradient>

                        <!-- Holographic shimmer -->
                        <linearGradient id="holoShimmer" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:rgba(255,255,255,0)" />
                            <stop offset="40%" style="stop-color:rgba(255,255,255,0.1)" />
                            <stop offset="50%" style="stop-color:rgba(255,255,255,0.3)" />
                            <stop offset="60%" style="stop-color:rgba(255,255,255,0.1)" />
                            <stop offset="100%" style="stop-color:rgba(255,255,255,0)" />
                        </linearGradient>

                        <!-- Sakura pattern -->
                        <pattern id="sakuraPattern" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                            <circle cx="20" cy="20" r="3" fill="rgba(255,183,213,0.15)" />
                            <circle cx="0" cy="0" r="2" fill="rgba(255,183,213,0.1)" />
                            <circle cx="40" cy="40" r="2" fill="rgba(255,183,213,0.1)" />
                        </pattern>

                        <!-- Drop shadow -->
                        <filter id="packShadow" x="-20%" y="-20%" width="140%" height="140%">
                            <feDropShadow dx="0" dy="10" stdDeviation="15" flood-color="#FF2D8A" flood-opacity="0.3" />
                        </filter>
                    </defs>

                    <!-- Background -->
                    <rect width="200" height="280" rx="16" fill="url(#packGradient)" filter="url(#packShadow)" />

                    <!-- Pattern overlay -->
                    <rect width="200" height="280" rx="16" fill="url(#sakuraPattern)" />

                    <!-- Inner border -->
                    <rect x="8" y="8" width="184" height="264" rx="12" fill="none" stroke="rgba(255,255,255,0.2)"
                        stroke-width="1" />

                    <!-- Top decoration -->
                    <rect x="20" y="20" width="160" height="4" rx="2" fill="rgba(255,255,255,0.3)" />

                    <!-- Sakura corners -->
                    <text x="25" y="50" font-size="20" fill="rgba(255,255,255,0.6)">üå∏</text>
                    <text x="155" y="50" font-size="20" fill="rgba(255,255,255,0.6)">üå∏</text>

                    <!-- Pack icon -->
                    <text x="100" y="105" text-anchor="middle" font-size="50" fill="white"
                        filter="drop-shadow(0 0 10px rgba(255,255,255,0.5))">üé¥</text>

                    <!-- Main text -->
                    <text x="100" y="145" text-anchor="middle" font-family="Orbitron, sans-serif" font-weight="700"
                        font-size="18" fill="white" letter-spacing="0.1em">LOYALTY</text>
                    <text x="100" y="170" text-anchor="middle" font-family="Orbitron, sans-serif" font-weight="700"
                        font-size="18" fill="white" letter-spacing="0.1em">PACK</text>

                    <!-- Seal badge -->
                    <circle cx="100" cy="205" r="22" fill="rgba(255,215,0,0.2)" stroke="#FFD700" stroke-width="2" />
                    <text x="100" y="211" text-anchor="middle" font-family="Orbitron, sans-serif" font-weight="700"
                        font-size="8" fill="#FFD700" letter-spacing="0.05em">PREMIUM</text>

                    <!-- Brand text -->
                    <text x="100" y="250" text-anchor="middle" font-family="Outfit, sans-serif" font-weight="500"
                        font-size="9" fill="rgba(255,255,255,0.7)" letter-spacing="0.05em">üå∏ ONE STOP ANIME üå∏</text>

                    <!-- Year badge -->
                    <text x="100" y="265" text-anchor="middle" font-family="Orbitron, sans-serif" font-weight="400"
                        font-size="7" fill="rgba(255,215,0,0.7)" letter-spacing="0.2em">2026</text>

                    <!-- Holographic overlay -->
                    <rect width="200" height="280" rx="16" fill="url(#holoShimmer)" opacity="0.5">
                        <animate attributeName="opacity" values="0.3;0.6;0.3" dur="3s" repeatCount="indefinite" />
                    </rect>
                </svg>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="landing-actions" id="landing-actions">
            <button class="cta-button" onclick="showSignup()" id="join-button">
                <span class="btn-text">JOIN & OPEN YOUR PACK</span>
                <span class="btn-icon" aria-hidden="true">üé¥</span>
            </button>
            <button class="secondary-button" onclick="showLogin()" id="login-button">
                <span>Already a member? Login</span>
            </button>
        </div>

        <!-- Logged-in Actions (shown for authenticated users) -->
        <div class="landing-actions hidden" id="logged-in-actions">
            <button class="cta-button" onclick="showOpening()" id="open-pack-button">
                <span class="btn-text">OPEN NEW PACK</span>
                <span class="btn-icon" aria-hidden="true">üé¥</span>
            </button>
            <button class="secondary-button" onclick="showDashboard()">
                <span>View My Account</span>
            </button>
        </div>

        <!-- Reward Tiers Preview -->
        <div class="reward-tiers">
            <h3>Possible Rewards</h3>
            <div class="tier-grid">
                <div class="tier common">
                    <span class="rarity">COMMON</span>
                    <span class="reward">5% OFF</span>
                </div>
                <div class="tier uncommon">
                    <span class="rarity">UNCOMMON</span>
                    <span class="reward">10% OFF</span>
                </div>
                <div class="tier rare">
                    <span class="rarity">RARE</span>
                    <span class="reward">15% OFF</span>
                </div>
                <div class="tier ultra-rare">
                    <span class="rarity">ULTRA RARE</span>
                    <span class="reward">FREE BOOSTER</span>
                </div>
                <div class="tier secret-rare">
                    <span class="rarity">SECRET RARE</span>
                    <span class="reward">$50 CREDIT</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ==========================================
         LOGIN SCREEN
         ========================================== -->
    <div class="screen" id="login-screen">
        <button class="back-btn" onclick="showLanding()" aria-label="Go back to landing page">‚Üê Back</button>

        <h2 class="form-title">Welcome Back!</h2>
        <p class="form-subtitle">Login to access your rewards and open new packs</p>

        <form id="login-form" onsubmit="return handleLogin(event)" novalidate>
            <div class="form-group">
                <label for="login-email">Email Address</label>
                <input type="email" id="login-email" name="email" required placeholder="your@email.com"
                    autocomplete="email">
                <span class="input-icon" aria-hidden="true">‚úâÔ∏è</span>
            </div>

            <div class="form-group">
                <label for="login-password">Password</label>
                <div class="password-wrapper">
                    <input type="password" id="login-password" name="password" required
                        placeholder="Enter your password" autocomplete="current-password">
                    <span class="input-icon" aria-hidden="true">üîí</span>
                    <button type="button" class="password-toggle" onclick="togglePassword('login-password')"
                        aria-label="Show password">
                        <span class="eye-icon">üëÅÔ∏è</span>
                    </button>
                </div>
            </div>

            <div class="form-error hidden" id="login-error">
                <span>‚ùå</span> <span id="login-error-text">Invalid email or password</span>
            </div>

            <button type="submit" class="cta-button submit-btn">
                <span class="btn-text">LOGIN</span>
                <span class="btn-icon" aria-hidden="true">üîì</span>
            </button>

            <p class="form-switch">
                Don't have an account? <a href="#" onclick="showSignup(); return false;">Create one</a>
            </p>
        </form>
    </div>

    <!-- ==========================================
         SIGNUP SCREEN
         ========================================== -->
    <div class="screen" id="signup-screen">
        <button class="back-btn" onclick="showLanding()" aria-label="Go back to landing page">‚Üê Back</button>

        <h2 class="form-title">Join the Collector's Circle</h2>
        <p class="form-subtitle">Create your account to start collecting rewards</p>

        <!-- Netlify Forms Integration -->
        <form id="signup-form" name="loyalty-signup" method="POST" data-netlify="true" data-netlify-honeypot="bot-field"
            onsubmit="return handleSignup(event)" novalidate>
            <!-- Honeypot field for spam protection -->
            <input type="hidden" name="form-name" value="loyalty-signup">
            <p class="hidden">
                <label>Don't fill this out if you're human: <input name="bot-field"></label>
            </p>

            <div class="form-group">
                <label for="name">Trainer Name</label>
                <input type="text" id="name" name="name" required placeholder="Enter your name" autocomplete="name">
                <span class="input-icon" aria-hidden="true">üë§</span>
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required placeholder="your@email.com" autocomplete="email">
                <span class="input-icon" aria-hidden="true">‚úâÔ∏è</span>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <div class="password-wrapper">
                    <input type="password" id="password" name="password" required placeholder="Create a password"
                        autocomplete="new-password" minlength="6">
                    <span class="input-icon" aria-hidden="true">üîí</span>
                    <button type="button" class="password-toggle" onclick="togglePassword('password')"
                        aria-label="Show password">
                        <span class="eye-icon">üëÅÔ∏è</span>
                    </button>
                </div>
                <div class="password-strength" id="password-strength"></div>
            </div>

            <div class="form-group">
                <label for="confirm-password">Confirm Password</label>
                <div class="password-wrapper">
                    <input type="password" id="confirm-password" name="confirm-password" required
                        placeholder="Confirm your password" autocomplete="new-password">
                    <span class="input-icon" aria-hidden="true">üîí</span>
                </div>
            </div>

            <div class="form-group">
                <label for="phone">Phone (Optional)</label>
                <input type="tel" id="phone" name="phone" placeholder="For SMS alerts on rare drops" autocomplete="tel">
                <span class="input-icon" aria-hidden="true">üì±</span>
            </div>

            <div class="form-group">
                <label for="favorite">Favorite TCG</label>
                <select id="favorite" name="favorite">
                    <option value="">Select your main game...</option>
                    <option value="pokemon">Pok√©mon TCG</option>
                    <option value="yugioh">Yu-Gi-Oh!</option>
                    <option value="onepiece">One Piece TCG</option>
                    <option value="digimon">Digimon TCG</option>
                    <option value="dragonball">Dragon Ball Super</option>
                    <option value="weiss">Wei√ü Schwarz</option>
                    <option value="union">Union Arena</option>
                    <option value="other">Other / Multiple</option>
                </select>
                <span class="input-icon" aria-hidden="true">üé¥</span>
            </div>

            <div class="form-group checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="terms" name="terms" required>
                    <span class="checkmark" aria-hidden="true"></span>
                    I agree to receive rewards and exclusive offers
                </label>
            </div>

            <div class="form-error hidden" id="signup-error">
                <span>‚ùå</span> <span id="signup-error-text">Please fix the errors above</span>
            </div>

            <button type="submit" class="cta-button submit-btn">
                <span class="btn-text">CREATE ACCOUNT & OPEN PACK</span>
                <span class="btn-icon" aria-hidden="true">‚ú®</span>
            </button>

            <p class="form-switch">
                Already have an account? <a href="#" onclick="showLogin(); return false;">Login</a>
            </p>
        </form>
    </div>

    <!-- ==========================================
         ACCOUNT DASHBOARD SCREEN
         ========================================== -->
    <div class="screen" id="dashboard-screen">
        <button class="back-btn" onclick="showLanding()" aria-label="Go back to landing page">‚Üê Back</button>

        <div class="dashboard-container">
            <!-- Profile Card -->
            <div class="profile-card">
                <div class="profile-avatar">
                    <span id="profile-avatar-emoji">üå∏</span>
                </div>
                <div class="profile-info">
                    <h2 class="profile-name" id="profile-name">Trainer Name</h2>
                    <p class="profile-email" id="profile-email">email@example.com</p>
                    <p class="profile-member-id" id="profile-member-id">#ABC123</p>
                </div>
                <div class="profile-stats">
                    <div class="stat">
                        <span class="stat-value" id="packs-opened">0</span>
                        <span class="stat-label">Packs Opened</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="total-rewards">0</span>
                        <span class="stat-label">Rewards Earned</span>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="dashboard-actions">
                <button class="cta-button" onclick="showOpening()">
                    <span class="btn-text">OPEN NEW PACK</span>
                    <span class="btn-icon" aria-hidden="true">üé¥</span>
                </button>
            </div>

            <!-- Reward History -->
            <div class="reward-history">
                <h3>üèÜ Reward History</h3>
                <div class="rewards-list" id="rewards-list">
                    <!-- Rewards will be inserted here dynamically -->
                    <p class="no-rewards hidden" id="no-rewards">No rewards yet! Open a pack to get started.</p>
                </div>
            </div>

            <!-- Logout Button -->
            <button class="logout-btn" onclick="logout()">
                <span>üö™</span> Logout
            </button>
        </div>
    </div>

    <!-- ==========================================
         PACK OPENING SCREEN
         ========================================== -->
    <div class="screen" id="opening-screen">
        <div class="opening-container">
            <h2 class="opening-title">Your Loyalty Pack</h2>
            <p class="opening-subtitle">Hold the pack to charge it with energy!</p>

            <div class="pack-opening" id="pack-container" role="button" aria-label="Hold to charge and open pack"
                tabindex="0">
                <!-- Sealed Pack -->
                <div class="pack-sealed" id="pack-sealed">
                    <div class="pack-shine" aria-hidden="true"></div>
                    <div class="pack-content">
                        <span class="pack-emoji" aria-hidden="true">üé¥</span>
                        <span class="pack-label">LOYALTY PACK</span>
                        <span class="pack-brand">ONE STOP ANIME</span>
                        <span class="pack-year">2026</span>
                    </div>
                    <div class="tear-indicator" aria-hidden="true">
                        <span>HOLD TO CHARGE</span>
                        <div class="tear-arrow">‚Üì</div>
                    </div>
                </div>

                <!-- Torn Pack -->
                <div class="pack-torn hidden" id="pack-torn" aria-hidden="true">
                    <div class="torn-top"></div>
                    <div class="cards-emerging">
                        <div class="card-back" id="reward-card-back" role="button"
                            aria-label="Tap to reveal your reward" tabindex="0">
                            <div class="card-pattern"></div>
                            <span class="card-logo">OSA</span>
                        </div>
                    </div>
                    <div class="torn-bottom"></div>
                </div>
            </div>

            <p class="tap-hint" id="tap-hint">Hold the pack to charge, then release!</p>
        </div>
    </div>

    <!-- ==========================================
         CARD REVEAL SCREEN
         ========================================== -->
    <div class="screen" id="reveal-screen">
        <div class="reveal-container">
            <div class="card-spotlight" aria-hidden="true"></div>

            <!-- Reward Card -->
            <div class="reward-card" id="reward-card">
                <div class="card-inner">
                    <div class="card-front">
                        <div class="card-frame">
                            <div class="card-holographic" aria-hidden="true"></div>

                            <!-- Card Header -->
                            <div class="card-header">
                                <span class="card-name" id="card-name">REWARD CARD</span>
                                <span class="card-rarity-icon" id="rarity-icon" aria-hidden="true">‚≠ê</span>
                            </div>

                            <!-- Card Art -->
                            <div class="card-image-container">
                                <div class="card-art" id="card-art" aria-hidden="true">üéÅ</div>
                            </div>

                            <!-- Card Info -->
                            <div class="card-info">
                                <div class="card-type" id="card-type">LOYALTY REWARD</div>
                                <div class="card-rarity" id="card-rarity">COMMON</div>
                            </div>

                            <!-- Card Description -->
                            <div class="card-description">
                                <p id="card-description">Your exclusive reward awaits!</p>
                            </div>

                            <!-- Reward Display -->
                            <div class="card-reward">
                                <span class="reward-label">YOUR REWARD</span>
                                <span class="reward-value" id="reward-value">5% OFF</span>
                            </div>

                            <!-- Promo Code -->
                            <div class="card-code">
                                <span class="code-label">PROMO CODE</span>
                                <span class="code-value" id="promo-code">OSA-XXXXX</span>
                            </div>

                            <!-- Card Footer -->
                            <div class="card-footer">
                                <span class="member-name" id="member-name">Trainer Name</span>
                                <span class="member-id" id="member-id">#000001</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="reveal-actions">
                <button class="action-btn primary" onclick="copyCode()" aria-label="Copy promo code to clipboard">
                    <span aria-hidden="true">üìã</span> Copy Code
                </button>
                <button class="action-btn secondary" onclick="shareReward()" aria-label="Share your reward">
                    <span aria-hidden="true">üì§</span> Share
                </button>
            </div>

            <!-- Success Message -->
            <div class="reveal-message" id="reveal-message">
                <h3>Congratulations! üéâ</h3>
                <p>Your reward has been saved to your account. Use it on your next purchase!</p>
            </div>

            <!-- Navigation Buttons -->
            <div class="reveal-navigation">
                <button class="secondary-button" onclick="showDashboard()">
                    <span>View My Account</span>
                </button>
                <a href="https://onestopanime.netlify.app/" class="shop-link" target="_blank" rel="noopener">
                    Shop Now at One Stop Anime ‚Üí
                </a>
            </div>
        </div>
    </div>

    <!-- ==========================================
         EFFECTS CONTAINERS
         ========================================== -->

    <!-- Confetti Container -->
    <div class="confetti-container" id="confetti" aria-hidden="true"></div>

    <!-- Netlify Identity Modal Container -->
    <div id="netlify-modal"></div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="loyalty-auth.js"></script>
</body>

</html>